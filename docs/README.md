# 仙侠世界引擎 (XianXia World Engine)

一个基于文本的仙侠世界模拟器，通过精心设计的数据结构和高效的本地计算，为玩家提供自由度极高的修仙世界探索体验。

## 项目特色

- 🗡️ **完整的修仙体系**：从聚气期到合体期的完整境界系统
- ⚔️ **策略战斗系统**：基于五行相克的战斗机制
- 🧠 **智能AI系统**：不同性格的NPC行为模式
- 📜 **灵活的技能系统**：多种修炼路线和技能组合
- 🎮 **自然语言交互**：支持自然语言命令，可集成大模型API增强理解能力

## 快速开始

### 1. 环境要求

- Python 3.11+
- requests 库（已包含在 `requirements.txt` 中）

### 2. 安装依赖

```bash
pip install -r requirements.txt
```

### 3. 运行测试

首先运行测试确保系统正常：

```bash
python test_basic.py
```

### 4. 开始游戏

```bash
python main.py
```

## 游戏命令

### 自然语言支持

除了使用固定命令外，你还可以使用更自然的语言：
- “我想攻击那个妖兽”
- “用剑气斩攻击敌人”
- “看看我的状态”
- “我要修炼一会儿”
- “快跑！”

### 基础命令
- `状态` - 查看角色属性
- `背包` - 查看物品（开发中）
- `技能` - 查看已学技能
- `地图` - 查看当前位置
- `帮助` - 显示所有命令

### 战斗命令
- `攻击 [目标]` - 进行普通攻击
- `使用 [技能名] [目标]` - 使用技能
- `防御` - 进入防御姿态
- `逃跑` - 尝试逃离战斗

### 探索命令
- `探索` - 探索当前区域
- `修炼` - 打坐修炼，恢复状态

### 系统命令
- `保存` - 保存游戏进度
- `退出` - 退出游戏

## 项目结构

```
xianxia_world_engine/
├── xwe/
│   ├── core/           # 核心游戏系统
│   │   ├── attributes.py    # 属性系统
│   │   ├── character.py     # 角色系统
│   │   ├── skills.py        # 技能系统
│   │   ├── combat.py        # 战斗系统
│   │   ├── ai.py           # AI系统
│   │   ├── command_parser.py # 命令解析
│   │   └── game_core.py     # 游戏主循环
│   ├── engine/         # 表达式引擎
│   │   └── expression/      # 数学表达式解析器
│   └── data/           # 游戏数据文件
│       ├── world/          # 世界设定
│       ├── character/      # 角色模板
│       ├── combat/         # 战斗配置
│       ├── skills/         # 技能数据
│       └── attribute/      # 属性配置
├── archive/           # 旧版脚本与备份
├── main.py            # 游戏入口
└── test_basic.py      # 基础测试

```
所有历史文件都已迁至 `archive/`，方便后续整理。

## 开发特性

### 表达式解析器
- 安全的数学表达式计算
- 支持变量和函数
- 可扩展的函数库

### 数据驱动设计
- 所有游戏数据使用JSON配置
- 支持热更新
- 易于修改和扩展

### AI行为树
- 基于行为树的NPC决策
- 多种AI性格：激进、防御、均衡
- 智能目标选择和威胁评估

## 配置LLM API（可选）

为了获得更好的自然语言理解效果，你可以配置大模型API：

### DeepSeek API
```bash
export DEEPSEEK_API_KEY="你的API密钥"
```

### OpenAI API
```bash
export OPENAI_API_KEY="你的API密钥"
```

然后修改`xwe/data/interaction/nlp_config.json`中的`llm_provider`为对应的提供者。

## 开发计划

- [ ] 物品系统
- [ ] 门派系统
- [ ] 任务系统
- [ ] 阵法系统
- [ ] 炼丹炼器
- [ ] 多人组队
- [ ] 随机事件
- [ ] 秘境探索

## 贡献指南

欢迎提交Issue和Pull Request！

## 许可证

MIT License

---

**注意**：这是一个正在开发中的项目，某些功能可能还不完善。
