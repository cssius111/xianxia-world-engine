{% extends "base.html" %}

{% block title %}ä¿®ä»™ä¸–ç•Œå¼•æ“{% endblock %}

{% block content %}
<div id="gameContainer" class="game-container">
    {% include "components/header.html" %}

    <div class="main-layout">
        {% include "components/sidebar_v2.html" %}
        <main id="mainLogArea">
            {% include "components/narrative_log.html" %}
            {% include "components/command_input.html" %}
        </main>
    </div>

    {% include "components/game_panels.html" %}
    {% include "components/roll_modal.html" %}
    {% include "components/welcome_modal_v2.html" %}
    {% include "components/world_intro.html" %}
    {% include "components/lore_modal.html" %}
    {% include "components/event_modal.html" %}
    {% include "modals/settings.html" %}
    <div id="modal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);overflow:auto;z-index:1000;">
        <div id="modal-content" style="background:#222;margin:10% auto;padding:20px;border-radius:8px;max-width:600px;color:#ddd;"></div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/game_main.js') }}"></script>
<script src="{{ url_for('static', filename='js/game_panels_enhanced.js') }}"></script>
<script>
    async function openModal(name) {
        const modal = document.getElementById('modal');
        const content = document.getElementById('modal-content');
        modal.style.display = 'block';
        const resp = await fetch(`/modal/${name}`);
        content.innerHTML = await resp.text();
    }

    function closeModal() {
        document.getElementById('modal').style.display = 'none';
    }

    function continueGame() {
        window.location.href = '/continue';
    }

    window.onload = function() {
        GameUI.init(); // åˆå§‹åŒ–æ¸¸æˆ UI åŠŸèƒ½ï¼ˆç»‘å®šæ—¥å¿—ã€æŒ‡ä»¤æ¡†ã€å¼¹çª—ç­‰ï¼‰
        WelcomeSystem.show(); // å¯åŠ¨æ¬¢è¿ç•Œé¢
        console.log('ğŸ® ä¿®ä»™æ¸¸æˆå·²å¯åŠ¨ (å¢å¼ºç‰ˆ)');
    };
</script>
{% endblock %}
